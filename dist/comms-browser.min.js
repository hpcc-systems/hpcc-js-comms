!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.HPCCComms=t.HPCCComms||{})}(this,function(t){"use strict";function e(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function n(){}function r(t,e){var r=new n;if(t instanceof n)t.each(function(t,e){r.set(e,t)});else if(Array.isArray(t)){var o,i=-1,s=t.length;if(null==e)for(;++i<s;)r.set(i,t[i]);else for(;++i<s;)r.set(e(o=t[i],i,t),o)}else if(t)for(var u in t)r.set(u,t[u]);return r}function o(){}function i(t,e){var n=new o;if(t instanceof o)t.each(function(t){n.add(t)});else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}function s(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new u(r)}function u(t){this._=t}function c(t,e){return t.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}function a(t,e){for(var n,r=0,o=t.length;r<o;++r)if((n=t[r]).name===e)return n.value}function l(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=S,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}function f(t){return function(e,n){t(null==e?n:null)}}function p(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function h(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}")}function d(t,e){var n=h(t);return function(r,o){return e(n(r),o,t)}}function y(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var r in t)r in e||n.push(e[r]=r)}),n}function v(t,e){return function(n){return t(n.responseText,e)}}function g(t,e){if("string"!=typeof e)return t;if(0===e.length)return t;for(;0===t.indexOf(e);)t=t.substring(1);for(;m(t,e);)t=t.substring(0,t.length-1);return t}function m(t,e,n){var r=t.toString();("number"!=typeof n||!isFinite(n)||Math.floor(n)!==n||n>r.length)&&(n=r.length),n-=e.length;var o=r.lastIndexOf(e,n);return-1!==o&&o===n}function w(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(t.length&&t[0].length&&"/"===t[0].charAt(0)?"/":"")+t.map(function(t){return g(t,"/")}).join("/")}var _="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},b=function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t,n){!function(n,r){t.exports=function(){function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function n(t){return"function"==typeof t}function r(t){G=t}function o(t){H=t}function i(){return void 0!==$?function(){$(u)}:s()}function s(){var t=setTimeout;return function(){return t(u,1)}}function u(){for(var t=0;t<X;t+=2){(0,Q[t])(Q[t+1]),Q[t]=void 0,Q[t+1]=void 0}X=0}function c(t,e){var n=arguments,r=this,o=new this.constructor(l);void 0===o[Z]&&A(o);var i=r._state;return i?function(){var t=n[i-1];H(function(){return E(i,o,t,r._result)})}():S(r,o,t,e),o}function a(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(l);return m(n,t),n}function l(){}function f(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function h(t){try{return t.then}catch(t){return rt.error=t,rt}}function d(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function y(t,e,n){H(function(t){var r=!1,o=d(n,e,function(n){r||(r=!0,e!==n?m(t,n):b(t,n))},function(e){r||(r=!0,T(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,T(t,o))},t)}function v(t,e){e._state===et?b(t,e._result):e._state===nt?T(t,e._result):S(e,void 0,function(e){return m(t,e)},function(e){return T(t,e)})}function g(t,e,r){e.constructor===t.constructor&&r===c&&e.constructor.resolve===a?v(t,e):r===rt?T(t,rt.error):void 0===r?b(t,e):n(r)?y(t,e,r):b(t,e)}function m(e,n){e===n?T(e,f()):t(n)?g(e,n,h(n)):b(e,n)}function w(t){t._onerror&&t._onerror(t._result),O(t)}function b(t,e){t._state===tt&&(t._result=e,t._state=et,0!==t._subscribers.length&&H(O,t))}function T(t,e){t._state===tt&&(t._state=nt,t._result=e,H(w,t))}function S(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+et]=n,o[i+nt]=r,0===i&&t._state&&H(O,t)}function O(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?E(n,r,o,i):o(i);t._subscribers.length=0}}function R(){this.error=null}function C(t,e){try{return t(e)}catch(t){return ot.error=t,ot}}function E(t,e,r,o){var i=n(r),s=void 0,u=void 0,c=void 0,a=void 0;if(i){if(s=C(r,o),s===ot?(a=!0,u=s.error,s=null):c=!0,e===s)return void T(e,p())}else s=o,c=!0;e._state!==tt||(i&&c?m(e,s):a?T(e,u):t===et?b(e,s):t===nt&&T(e,s))}function j(t,e){try{e(function(e){m(t,e)},function(e){T(t,e)})}catch(e){T(t,e)}}function x(){return it++}function A(t){t[Z]=it++,t._state=void 0,t._result=void 0,t._subscribers=[]}function I(t,e){this._instanceConstructor=t,this.promise=new t(l),this.promise[Z]||A(this.promise),L(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?b(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&b(this.promise,this._result))):T(this.promise,P())}function P(){return new Error("Array Methods must be provided an Array")}function k(t){return new I(this,t).promise}function q(t){var e=this;return new e(L(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function z(t){var e=this,n=new e(l);return T(n,t),n}function N(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function D(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function U(t){this[Z]=x(),this._result=this._state=void 0,this._subscribers=[],l!==t&&("function"!=typeof t&&N(),this instanceof U?j(this,t):D())}function J(){var t=void 0;if(void 0!==_)t=_;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=U}var M=void 0;M=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var L=M,X=0,$=void 0,G=void 0,H=function(t,e){Q[X]=t,Q[X+1]=e,2===(X+=2)&&(G?G(u):V())},F="undefined"!=typeof window?window:void 0,W=F||{},Y=W.MutationObserver||W.WebKitMutationObserver,B="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),K="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Q=new Array(1e3),V=void 0;V=B?function(){return function(){return process.nextTick(u)}}():Y?function(){var t=0,e=new Y(u),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():K?function(){var t=new MessageChannel;return t.port1.onmessage=u,function(){return t.port2.postMessage(0)}}():void 0===F&&"function"==typeof e?function(){try{var t=e,n=t("vertx");return $=n.runOnLoop||n.runOnContext,i()}catch(t){return s()}}():s();var Z=Math.random().toString(36).substring(16),tt=void 0,et=1,nt=2,rt=new R,ot=new R,it=0;return I.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===tt&&n<t;n++)this._eachEntry(e[n],n)},I.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===a){var o=h(t);if(o===c&&t._state!==tt)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===U){var i=new n(l);g(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},I.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===tt&&(this._remaining--,t===nt?T(r,n):this._result[e]=n),0===this._remaining&&b(r,this._result)},I.prototype._willSettleAt=function(t,e){var n=this;S(t,void 0,function(t){return n._settledAt(et,e,t)},function(t){return n._settledAt(nt,e,t)})},U.all=k,U.race=q,U.resolve=a,U.reject=z,U._setScheduler=r,U._setAsap=o,U._asap=H,U.prototype={constructor:U,then:c,catch:function(t){return this.then(null,t)}},U.polyfill=J,U.Promise=U,U}()}()});b.polyfill();n.prototype=r.prototype={constructor:n,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var T=r.prototype;o.prototype=i.prototype={constructor:o,has:T.has,add:function(t){return t+="",this["$"+t]=t,this},remove:T.remove,clear:T.clear,values:T.keys,size:T.size,empty:T.empty,each:T.each};var S={value:function(){}};u.prototype=s.prototype={constructor:u,on:function(t,e){var n,r=this._,o=c(t+"",r),i=-1,s=o.length;{if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++i<s;)if(n=(t=o[i]).type)r[n]=l(r[n],t.name,e);else if(null==e)for(n in r)r[n]=l(r[n],t.name,null);return this}for(;++i<s;)if((n=(t=o[i]).type)&&(n=a(r[n],t.name)))return n}},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new u(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=this._[t],i=0,n=r.length;i<n;++i)r[i].value.apply(e,o)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,i=r.length;o<i;++o)r[o].value.apply(e,n)}};var O=function(t,e){function n(t){var e,n=h.status;if(!n&&p(h)||n>=200&&n<300||304===n){if(u)try{e=u.call(o,h)}catch(t){return void a.call("error",o,t)}else e=h;a.call("load",o,e)}else a.call("error",o,t)}var o,i,u,c,a=s("beforesend","progress","load","error"),l=r(),h=new XMLHttpRequest,d=null,y=null,v=0;if("undefined"==typeof XDomainRequest||"withCredentials"in h||!/^(http(s)?:)?\/\//.test(t)||(h=new XDomainRequest),"onload"in h?h.onload=h.onerror=h.ontimeout=n:h.onreadystatechange=function(t){h.readyState>3&&n(t)},h.onprogress=function(t){a.call("progress",o,t)},o={header:function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l.get(t):(null==e?l.remove(t):l.set(t,e+""),o)},mimeType:function(t){return arguments.length?(i=null==t?null:t+"",o):i},responseType:function(t){return arguments.length?(c=t,o):c},timeout:function(t){return arguments.length?(v=+t,o):v},user:function(t){return arguments.length<1?d:(d=null==t?null:t+"",o)},password:function(t){return arguments.length<1?y:(y=null==t?null:t+"",o)},response:function(t){return u=t,o},get:function(t,e){return o.send("GET",t,e)},post:function(t,e){return o.send("POST",t,e)},send:function(e,n,r){return h.open(e,t,!0,d,y),null==i||l.has("accept")||l.set("accept",i+",*/*"),h.setRequestHeader&&l.each(function(t,e){h.setRequestHeader(e,t)}),null!=i&&h.overrideMimeType&&h.overrideMimeType(i),null!=c&&(h.responseType=c),v>0&&(h.timeout=v),null==r&&"function"==typeof n&&(r=n,n=null),null!=r&&1===r.length&&(r=f(r)),null!=r&&o.on("error",r).on("load",function(t){r(null,t)}),a.call("beforesend",o,h),h.send(null==n?null:n),o},abort:function(){return h.abort(),o},on:function(){var t=a.on.apply(a,arguments);return t===a?o:t}},null!=e){if("function"!=typeof e)throw new Error("invalid callback: "+e);return o.get(e)}return o},R=function(t,e){return function(n,r){var o=O(n).mimeType(t).response(e);if(null!=r){if("function"!=typeof r)throw new Error("invalid callback: "+r);return o.get(r)}return o}};R("text/html",function(t){return document.createRange().createContextualFragment(t.responseText)}),R("application/json",function(t){return JSON.parse(t.responseText)}),R("text/plain",function(t){return t.responseText}),R("application/xml",function(t){var e=t.responseXML;if(!e)throw new Error("parse error");return e});var C=function(t){function e(t,e){var r,o,i=n(t,function(t,n){if(r)return r(t,n-1);o=t,r=e?d(t,e):h(t)});return i.columns=o,i}function n(t,e){function n(){if(l>=a)return s;if(o)return o=!1,i;var e,n=l;if(34===t.charCodeAt(n)){for(var r=n;r++<a;)if(34===t.charCodeAt(r)){if(34!==t.charCodeAt(r+1))break;++r}return l=r+2,e=t.charCodeAt(r+1),13===e?(o=!0,10===t.charCodeAt(r+2)&&++l):10===e&&(o=!0),t.slice(n+1,r).replace(/""/g,'"')}for(;l<a;){var u=1;if(10===(e=t.charCodeAt(l++)))o=!0;else if(13===e)o=!0,10===t.charCodeAt(l)&&(++l,++u);else if(e!==c)continue;return t.slice(n,l-u)}return t.slice(n)}for(var r,o,i={},s={},u=[],a=t.length,l=0,f=0;(r=n())!==s;){for(var p=[];r!==i&&r!==s;)p.push(r),r=n();e&&null==(p=e(p,f++))||u.push(p)}return u}function r(e,n){return null==n&&(n=y(e)),[n.map(s).join(t)].concat(e.map(function(e){return n.map(function(t){return s(e[t])}).join(t)})).join("\n")}function o(t){return t.map(i).join("\n")}function i(e){return e.map(s).join(t)}function s(t){return null==t?"":u.test(t+="")?'"'+t.replace(/\"/g,'""')+'"':t}var u=new RegExp('["'+t+"\n\r]"),c=t.charCodeAt(0);return{parse:e,parseRows:n,format:r,formatRows:o}},E=C(","),j=E.parse,x=C("\t"),A=x.parse,I=function(t,e){return function(n,r,o){arguments.length<3&&(o=r,r=null);var i=O(n).mimeType(t);return i.row=function(t){return arguments.length?i.response(v(e,r=t)):r},i.row(r),o?i.get(o):i}};I("text/csv",j),I("text/tab-separated-values",A);var P,k=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},q=function(){function t(){this.stack=[]}return t.prototype.push=function(t){return this.stack.push(t),t},t.prototype.pop=function(){return this.stack.pop()},t.prototype.top=function(){return this.stack.length?this.stack[this.stack.length-1]:void 0},t.prototype.depth=function(){return this.stack.length},t}(),z=(new Function("try{return global;}catch(e){return window;}")(),new Function("try{return this===global;}catch(e){return false;}"));!function(t){t[t.debug=0]="debug",t[t.info=1]="info",t[t.notice=2]="notice",t[t.warning=3]="warning",t[t.error=4]="error",t[t.critical=5]="critical",t[t.alert=6]="alert",t[t.emergency=7]="emergency"}(P||(P={}));var N={debug:"cyan",info:"green",notice:"grey",warning:"blue",errpr:"red",critical:"magenta",alert:"magenta",emergency:"magenta"},D=function(){function t(){this._levelStack=new q,this._level=P.error,this._filter=""}return t.Instance=function(){return this._instance||(this._instance=new this)},t.prototype.stringify=function(t){var e=[];return JSON.stringify(t,function(t,n){if("object"==typeof n&&null!==n){if(-1!==e.indexOf(n))return;e.push(n)}return n},2)},t.prototype.log=function(t,e,n){if(!(t<this._level||this._filter&&this._filter!==e)){var r=new Date,o=r.toISOString();"string"!=typeof n&&(n=this.stringify(n)),z?console.log("["+o+"] "+P[t].toUpperCase()+" "+e+":  "+n):console.log("["+o+"] %c"+P[t].toUpperCase()+"%c "+e+":  "+n,"color:"+N[P[t]],"")}},t.prototype.debug=function(t,e){this.log(P.debug,t,e)},t.prototype.info=function(t,e){this.log(P.info,t,e)},t.prototype.notice=function(t,e){this.log(P.notice,t,e)},t.prototype.warning=function(t,e){this.log(P.warning,t,e)},t.prototype.error=function(t,e){this.log(P.error,t,e)},t.prototype.critical=function(t,e){this.log(P.critical,t,e)},t.prototype.alert=function(t,e){this.log(P.alert,t,e)},t.prototype.emergency=function(t,e){this.log(P.emergency,t,e)},t.prototype.level=function(t){return arguments.length?(this._level=t,this):this._level},t.prototype.pushLevel=function(t){return this._levelStack.push(this._level),this._level=t,this},t.prototype.popLevel=function(){return this._level=this._levelStack.pop(),this},t.prototype.filter=function(t){return arguments.length?(this._filter=t,this):this._filter},t}(),U=D.Instance(),J=function(){function t(t){this._scopeID=t}return t.prototype.debug=function(t){U.debug(this._scopeID,t)},t.prototype.info=function(t){U.info(this._scopeID,t)},t.prototype.notice=function(t){U.notice(this._scopeID,t)},t.prototype.warning=function(t){U.warning(this._scopeID,t)},t.prototype.error=function(t){U.error(this._scopeID,t)},t.prototype.critical=function(t){U.critical(this._scopeID,t)},t.prototype.alert=function(t){U.alert(this._scopeID,t)},t.prototype.emergency=function(t){U.emergency(this._scopeID,t)},t.prototype.pushLevel=function(t){return U.pushLevel(t),this},t.prototype.popLevel=function(){return U.popLevel(),this},t}(),M=function(t,e){return void 0===e&&(e=!0),e&&U.filter(t),new J(t)}("comms/connection.ts");!function(t){t[t.POST=0]="POST",t[t.GET=1]="GET",t[t.JSONP=2]="JSONP"}(t.RequestType||(t.RequestType={})),function(t){t[t.JSON=0]="JSON",t[t.TEXT=1]="TEXT"}(t.ResponseType||(t.ResponseType={}));var L={type:t.RequestType.POST,baseUrl:"",userID:"",password:"",rejectUnauthorized:!1,timeoutSecs:60},X=null,$=null,G=function(){function e(t){this.opts(t)}return e.prototype.serialize=function(t,e){var n=this;if(void 0===e&&(e=""),e&&(e+="."),"object"!=typeof t)return encodeURIComponent(t);var r=[],o=this;for(var i in t)!function(i){if(t.hasOwnProperty(i))if(t[i]instanceof Array){var s=!1;t[i].forEach(function(t,o){"object"==typeof t?(s=!0,r.push(n.serialize(t,e+encodeURIComponent(i+"."+o)))):r.push(e+encodeURIComponent(i+"_i"+o)+"="+n.serialize(t))}),s&&r.push(e+encodeURIComponent(i+".itemcount")+"="+t[i].length)}else"object"==typeof t[i]?r.push(o.serialize(t[i],e+encodeURIComponent(i))):r.push(e+encodeURIComponent(i)+"="+encodeURIComponent(t[i]))}(i);return r.join("&")},e.prototype.deserialize=function(t){return JSON.parse(t)},e.prototype.nodeRequestSend=function(e,n,r,o){var i=this;return void 0===o&&(o=t.ResponseType.JSON),new Promise(function(s,u){var c={method:e,uri:w(i._opts.baseUrl,n),auth:{user:i._opts.userID,pass:i._opts.password,sendImmediately:!0},username:i._opts.userID,password:i._opts.password,timeout:1e3*i._opts.timeoutSecs},a="Basic "+btoa(i._opts.userID+":"+i._opts.password);switch(e){case"GET":c.headers={Authorization:a},c.uri+="?"+i.serialize(r);break;case"POST":c.headers={"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded",Authorization:a},c.rejectUnauthorized=i._opts.rejectUnauthorized,c.body=i.serialize(r)}X(c,function(e,n,r){e?u(new Error(e)):n&&200===n.statusCode?s(o===t.ResponseType.JSON?i.deserialize(r):r):u(new Error(r))})})},e.prototype.d3Send=function(e,n,r,o){var i=this;return void 0===o&&(o=t.ResponseType.JSON),new Promise(function(s,u){var c={method:e,uri:w(i._opts.baseUrl,n),auth:{user:i._opts.userID,pass:i._opts.password,sendImmediately:!0},username:i._opts.userID,password:i._opts.password};switch(e){case"GET":c.uri+="?"+i.serialize(r);break;case"POST":c.headers={"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},c.rejectUnauthorized=i._opts.rejectUnauthorized,c.body=i.serialize(r)}var a=$(c.uri).timeout(1e3*i._opts.timeoutSecs);"POST"===e&&a.header("X-Requested-With","XMLHttpRequest").header("Content-Type","application/x-www-form-urlencoded").header("Origin",null),a.send(e,c.body,function(e,n){e?u(new Error(e)):n&&200===n.status?s(o===t.ResponseType.JSON?i.deserialize(n.responseText):n.responseText):u(new Error(n.responseText))})})},e.prototype.post=function(e,n,r){if(void 0===r&&(r=t.ResponseType.JSON),X)return this.nodeRequestSend("POST",e,n,r);if($)return this.d3Send("POST",e,n,r);throw new Error("No transport")},e.prototype.get=function(e,n,r){if(void 0===r&&(r=t.ResponseType.JSON),X)return this.nodeRequestSend("GET",e,n,r);if($)return this.d3Send("GET",e,n,r);throw new Error("No transport")},e.prototype.jsonp=function(e,n,r){var o=this;return void 0===n&&(n={}),void 0===r&&(r=t.ResponseType.JSON),new Promise(function(i,s){function u(){delete window[a],document.body.removeChild(f)}var c=1e3*o._opts.timeoutSecs,a="jsonp_callback_"+Math.round(999999*Math.random()),l=o;window[a]=function(e){c=0,u(),i(r===t.ResponseType.JSON&&"string"==typeof e?l.deserialize(e):e)};var f=document.createElement("script"),p=w(o._opts.baseUrl,e);p+=p.indexOf("?")>=0?"&":"?",f.src=p+"jsonp="+a+"&"+o.serialize(n),document.body.appendChild(f);var h=setInterval(function(){c<=0?clearInterval(h):(c-=5e3,c<=0?(clearInterval(h),M.error("Request timeout:  "+f.src),u(),s(Error("Request timeout:  "+f.src))):M.debug("Request pending ("+c/1e3+" sec):  "+f.src))},5e3)})},e.prototype.opts=function(t){return 0===arguments.length?this._opts:(this._opts=k({},L,t),this)},e.prototype.send=function(e,n,r){switch(void 0===r&&(r=t.ResponseType.JSON),this._opts.type){case t.RequestType.JSONP:return this.jsonp(e,n,r);case t.RequestType.GET:return this.get(e,n,r);case t.RequestType.POST:default:return this.post(e,n,r)}},e.prototype.clone=function(){return new e(this.opts())},e}();!function(t){$=t}(O),t.version="0.0.1",t.Connection=G,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=comms-browser.min.js.map
